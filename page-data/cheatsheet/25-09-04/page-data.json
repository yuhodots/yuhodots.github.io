{"componentChunkName":"component---src-templates-post-js","path":"/cheatsheet/25-09-04/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p>OpenAI Agent SDK documentation을 읽고 핵심 내용과 사용 예제에 대해서 정리합니다.</p>\n</blockquote>\n<p>Agent를 개발하기 위한 도구로 이전에는 langchain, langgraph가 자주 사용되어 왔지만, 최근 들어서는 OpenAI Agent SDK가 자주 사용 및 언급되고 있습니다. OpenAI Agent SDK는 langgraph에 비해 다른 의존성이 적고, 사용 방법이 복잡하지 않으며, 기존 파이썬 문법에서 벗어나지 않는 특징을 가지고 있습니다. 따라서 저 또한 앞으로 Agent 관련된 코딩을 수행하게 되면 OpenAI Agent SDK 기반으로 작성하려고 하며, 이를 위해서 아래에 관련 핵심 개념들을 정리하게 되었습니다.</p>\n<p>OpenAI Agent SDK의 핵심 설계 원칙은 '경량성'과 'Python-First' 접근 방식입니다. 이는 개발자가 복잡하고 새로운 추상화 개념을 배울 필요 없이, 최소한의 핵심 요소들과 기존 파이썬 언어의 특징을 활용하여 직관적으로 에이전트 시스템을 구축할 수 있도록 돕습니다. 실제로 아래에서 자세한 개념 정리와 사용 예제를 확인해보면서 OpenAI Agent SDK를 익혀보도록 합시다.</p>\n<h3 id=\"1-quick-start\" style=\"position:relative;\"><a href=\"#1-quick-start\" aria-label=\"1 quick start permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Quick Start</h3>\n<p>기본적인 사용 예시부터 확인해보겠습니다. 각 용어에 대한 자세한 이해는 지금은 넘어가셔도 좋습니다.</p>\n<p>먼저, 에이전트를 정의합니다. (예제는 OpenAI Agent SDK docs에서 가져왔습니다.)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> Agent\n\nagent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"Math Tutor\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"You provide help with math problems. Explain your reasoning at each step and include examples\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\n\nhistory_tutor_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"History Tutor\"</span><span class=\"token punctuation\">,</span>\n    handoff_description<span class=\"token operator\">=</span><span class=\"token string\">\"Specialist agent for historical questions\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"You provide assistance with historical queries. Explain important events and context clearly.\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\n\nmath_tutor_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"Math Tutor\"</span><span class=\"token punctuation\">,</span>\n    handoff_description<span class=\"token operator\">=</span><span class=\"token string\">\"Specialist agent for math questions\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"You provide help with math problems. Explain your reasoning at each step and include examples\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>중심이 되는 traige_agent를 정의하고, 해당 에이전트에 handsoff를 정의합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">triage_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"Triage Agent\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"You determine which agent to use based on the user's homework question\"</span><span class=\"token punctuation\">,</span>\n    handoffs<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>history_tutor_agent<span class=\"token punctuation\">,</span> math_tutor_agent<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>워크플로우(즉, 중심이 되는 traige_agent)를 Runner.run을 통해 실행합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> Runner\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Runner<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>triage_agent<span class=\"token punctuation\">,</span> <span class=\"token string\">\"What is the capital of France?\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>final_output<span class=\"token punctuation\">)</span></code></pre></div>\n<p>혹시 입력과 출력에 대한 유효성 검증을 하고싶다면, guardrail을 추가해봅시다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> GuardrailFunctionOutput<span class=\"token punctuation\">,</span> Agent<span class=\"token punctuation\">,</span> Runner\n<span class=\"token keyword\">from</span> pydantic <span class=\"token keyword\">import</span> BaseModel\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">HomeworkOutput</span><span class=\"token punctuation\">(</span>BaseModel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    is_homework<span class=\"token punctuation\">:</span> <span class=\"token builtin\">bool</span>\n    reasoning<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span>\n\nguardrail_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"Guardrail check\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"Check if the user is asking about homework.\"</span><span class=\"token punctuation\">,</span>\n    output_type<span class=\"token operator\">=</span>HomeworkOutput<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">homework_guardrail</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> agent<span class=\"token punctuation\">,</span> input_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Runner<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>guardrail_agent<span class=\"token punctuation\">,</span> input_data<span class=\"token punctuation\">,</span> context<span class=\"token operator\">=</span>ctx<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">)</span>\n    final_output <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>final_output_as<span class=\"token punctuation\">(</span>HomeworkOutput<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> GuardrailFunctionOutput<span class=\"token punctuation\">(</span>\n        output_info<span class=\"token operator\">=</span>final_output<span class=\"token punctuation\">,</span>\n        tripwire_triggered<span class=\"token operator\">=</span><span class=\"token keyword\">not</span> final_output<span class=\"token punctuation\">.</span>is_homework<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span>\n    \ntriage_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"Triage Agent\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"You determine which agent to use based on the user's homework question\"</span><span class=\"token punctuation\">,</span>\n    handoffs<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>history_tutor_agent<span class=\"token punctuation\">,</span> math_tutor_agent<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    input_guardrails<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>\n        InputGuardrail<span class=\"token punctuation\">(</span>guardrail_function<span class=\"token operator\">=</span>homework_guardrail<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"2-basic-concepts\" style=\"position:relative;\"><a href=\"#2-basic-concepts\" aria-label=\"2 basic concepts permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Basic Concepts</h3>\n<p>이 파트에서는 OpenAI Agent SDK를 사용하기 위해 알아야 할 가장 기본 요소들에 대해서 소개합니다.</p>\n<h5 id=\"agents\" style=\"position:relative;\"><a href=\"#agents\" aria-label=\"agents permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Agents</h5>\n<p>Agent는 가장 핵심적인 구성 요소로, instructions과 tools로 구성된 LLM을 의미합니다.</p>\n<ul>\n<li><strong>name</strong>: 에이전트를 식별하는 필수 문자열입니다. 로깅, 디버깅, tracing 등에서 식별자로 사용됩니다.</li>\n<li><strong>instructions</strong>: 에이전트의 페르소나, 목표, 제약 조건 등을 정의하는 시스템 프롬프트입니다.</li>\n<li><strong>model</strong>: 사용할 LLM 모델입니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 간단한 에이전트는 이름과 지침만으로 생성할 수 있습니다.</span>\n<span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> Agent\n\nmath_tutor_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"Math Tutor\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"You provide help with math problems. Explain your reasoning at each step and include examples.\"</span><span class=\"token punctuation\">,</span>\n    model<span class=\"token operator\">=</span><span class=\"token string\">\"gpt-4o\"</span> <span class=\"token comment\"># 사용할 모델을 명시적으로 지정</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>다음과 같은 추가적인 기능들도 있습니다.</p>\n<ul>\n<li><code class=\"language-text\">output_type</code> 파라미터를 사용하면 에이전트가 단순한 텍스트가 아닌, Pydantic 모델이나 dataclass와 같이 구조화된 데이터를 생성하도록 할 수 있습니다.</li>\n<li><code class=\"language-text\">instructions</code> 파라미터에 문자열 대신 함수를 전달하는 것도 가능합니다. 현재 컨텍스트에 따라 시스템 프롬프트를 동적으로 생성하여 에이전트가 상황에 맞게 대응하도록 만들고 싶다면 이런 방식을 사용하시면 됩니다.</li>\n<li><code class=\"language-text\">clone()</code> 메서드를 사용하면 기존 에이전트를 복제하여 약간의 변형을 가한 새로운 에이전트를 손쉽게 생성할 수도 있습니다.</li>\n</ul>\n<h5 id=\"runner\" style=\"position:relative;\"><a href=\"#runner\" aria-label=\"runner permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Runner</h5>\n<p>Runner 클래스는 에이전트의 실행 흐름을 관리하는 구성 요소입니다. 즉, 정의된 에이전트에 생명을 불어넣는 엔진 역할을 합니다. <code class=\"language-text\">Runner.run()</code>을 호출하면 자동으로 실행되는 '<strong>Agent loop</strong>'는 OpenAI Agent SDK의 핵심적인 작동 방식이며 과정은 다음과 같습니다.</p>\n<ol>\n<li>Runner는 현재까지의 메시지 기록과 함께 LLM을 호출합니다.</li>\n<li>LLM은 응답을 반환하며, 이 응답에는 tool call이나 handoff 요청이 포함될 수 있습니다.</li>\n<li>만약 tool call이 있다면, Runner는 해당 도구를 실행하고 그 결과를 메시지 기록에 추가한 뒤, 다시 1번 단계로 돌아갑니다.</li>\n<li>이 루프는 \"최종 출력(final output)\"이 생성되면 종료됩니다.</li>\n</ol>\n<p>루프가 종료되는 조건은 두 가지입니다.</p>\n<ul>\n<li><code class=\"language-text\">output_type</code>이 설정된 경우엔, LLM이 해당 <strong>구조화된 타입과 일치하는 응답을 생성</strong>하면 루프가 종료됩니다.</li>\n<li><code class=\"language-text\">output_type</code>이 설정되지 않은 경우(일반 텍스트)엔, <strong>tool call이나 handoff가 포함되지 않은 첫 번째 LLM 응답</strong>이 최종 출력으로 간주되어 루프가 종료됩니다.</li>\n</ul>\n<p>Runner는 비동기 애플리케이션을 위한 <code class=\"language-text\">Runner.run()</code>과 동기 애플리케이션을 위한 <code class=\"language-text\">Runner.run_sync()</code> 실행 모드를 제공합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Runner는 최종 출력이 나올 때까지 에이전트 루프를 자동으로 처리합니다.</span>\n<span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> Runner\n\n<span class=\"token comment\"># 위에서 정의한 math_tutor_agent를 가정합니다.</span>\nuser_query <span class=\"token operator\">=</span> <span class=\"token string\">\"What is the Pythagorean theorem?\"</span>\n\n<span class=\"token comment\"># 비동기 실행</span>\nresult <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Runner<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>math_tutor_agent<span class=\"token punctuation\">,</span> user_query<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>final_output<span class=\"token punctuation\">)</span></code></pre></div>\n<p>이처럼 agent loop를 추상화한 것은 OpenAI Agent SDK의 핵심적인 가치입니다. 개발자가 직접 이런 loop를 구축하는 대신, 에이전트에 필요한 도구와 출력 타입을 설정하기만 하면 Runner가 나머지 복잡한 과정을 알아서 처리합니다.</p>\n<p>전체 응답이 생성될 때까지 기다리는 것보다, 토큰 단위로 응답을 스트리밍하는 것도 가능합니다. <code class=\"language-text\">Runner.run_streamed()</code> 메서드는 agent loop 중에 발생하는 텍스트 조각(delta), tool call 정보, 최종 출력 등 다양한 유형의 이벤트를 비동기적으로 생성하는 제너레이터(async generator)를 반환합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 스트리밍은 사용자에게 실시간 피드백을 제공합니다.</span>\n<span class=\"token comment\"># 아래는 일반적인 스트리밍 패턴에 기반한 개념적 예제입니다.</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">for</span> event <span class=\"token keyword\">in</span> Runner<span class=\"token punctuation\">.</span>run_streamed<span class=\"token punctuation\">(</span>agent<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Tell me a long story.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> event<span class=\"token punctuation\">.</span><span class=\"token builtin\">type</span> <span class=\"token operator\">==</span> <span class=\"token string\">'text_delta'</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>delta<span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> flush<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">elif</span> event<span class=\"token punctuation\">.</span><span class=\"token builtin\">type</span> <span class=\"token operator\">==</span> <span class=\"token string\">'final_output'</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n--- Story Complete ---\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>아래와 같이 정리해볼 수 있겠습니다.</p>\n<ul>\n<li><code class=\"language-text\">runner.run()</code>: 비동기 실행</li>\n<li><code class=\"language-text\">runner.run_sync()</code>: 동기 실행</li>\n<li><code class=\"language-text\">runner.run_streamed()</code>: 비동기 실행 + 스트리밍 지원</li>\n</ul>\n<h5 id=\"runresult\" style=\"position:relative;\"><a href=\"#runresult\" aria-label=\"runresult permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RunResult</h5>\n<p>Runner 호출의 결과물은 단순한 문자열이 아니라, 풍부한 정보를 담고 있는 <code class=\"language-text\">RunResult</code> 객체입니다.</p>\n<ul>\n<li><strong><code class=\"language-text\">result.final_output</code></strong>을 통해 에이전트의 최종 응답을 얻을 수 있습니다.</li>\n<li><strong><code class=\"language-text\">result.final_output_as(YourPydanticModel)</code> 메서드</strong>를 사용하면 구조화된 데이터를 안전하게 파싱하고 검증하여 가져올 수 있습니다.</li>\n</ul>\n<p>RunResult 객체에는 최종 출력뿐만 아니라, 실행 과정에서 발생한 모든 중간 단계의 tool call과 LLM의 생각 과정이 포함되어 있어 디버깅과 로깅에 유용합니다.</p>\n<p>추가적으로, <code class=\"language-text\">RunResultBase.to_input_list()</code> 사용하면 과거 conversation 들을 다음 turn의 인풋으로 쉽게 넣어줄 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">messages <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nmessages<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"role\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"user\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"content\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Remember the number 7814.\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nresponse <span class=\"token operator\">=</span> runner<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>messages<span class=\"token punctuation\">)</span>\nmessages <span class=\"token operator\">=</span> runner<span class=\"token punctuation\">.</span>to_input_list<span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span>\n\nmessages<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"role\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"user\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"content\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Multiply the last number by 103.8\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nresponse <span class=\"token operator\">=</span> runner<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>messages<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 이전 숫자를 기억하고 계산 수행</span></code></pre></div>\n<h3 id=\"3-tools--context\" style=\"position:relative;\"><a href=\"#3-tools--context\" aria-label=\"3 tools  context permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Tools &#x26; Context</h3>\n<p>이 파트에서는 에이전트가 외부와 상호작용하고 필요한 정보에 접근할 수 있는 능력을 부여하는 방법에 대해서 살펴봅니다.</p>\n<h5 id=\"tools\" style=\"position:relative;\"><a href=\"#tools\" aria-label=\"tools permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tools</h5>\n<p>Tool는 에이전트가 단순한 텍스트 생성을 넘어 웹 검색, 데이터베이스 접근, 외부 API 호출과 같은 의미 있는 행동을 취할 수 있게 해줍니다.</p>\n<p>Tool을 만드는 가장 기본적인 방법은 파이썬 함수에 <code class=\"language-text\">@function_tool</code> 데커레이터를 사용하는 것입니다. Open AI Agent SDK는 아래의 과정을 자동으로 수행합니다. 따라서 type hint와 docstring을 잘 작성해주는 것이 중요합니다.</p>\n<ul>\n<li>Type hint로부터 JSON 스키마 생성</li>\n<li>함수의 docstring을 파싱하여 tool 설명으로 사용</li>\n<li>Pydantic을 이용한 입력값 검증</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># @function_tool 데코레이터는 파이썬 함수를 즉시 도구로 변환합니다.</span>\n<span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> function_tool\n\n<span class=\"token decorator annotation punctuation\">@function_tool</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_weather</span><span class=\"token punctuation\">(</span>city<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"Returns the current weather for a specified city.\"\"\"</span>\n    <span class=\"token comment\"># 실제 애플리케이션에서는 이 부분에서 날씨 API를 호출합니다.</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"The weather in </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>city<span class=\"token punctuation\">}</span></span><span class=\"token string\"> is sunny and 25°C.\"</span></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"날씨비서\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"너는 날씨 정보를 제공하는 도우미야.\"</span><span class=\"token punctuation\">,</span>\n    tools<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>get_weather<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>이 외에도 아래와 같은 기능들도 존재합니다. </p>\n<ul>\n<li><code class=\"language-text\">WebSearchTool</code>, <code class=\"language-text\">CodeInterpreterTool</code>, <code class=\"language-text\">FileSearchTool</code>과 같이 OpenAI 서버에서 직접 실행되는 Hosted Tools들도 제공됩니다. 별도의 설정 없이 즉시 사용할 수 있습니다.</li>\n<li><strong><code class=\"language-text\">agent.as_tool()</code></strong> 메서드를 사용하면 에이전트를 tool로도 사용할 수 있습니다. </li>\n<li><strong><code class=\"language-text\">tool_choice</code></strong> 파라미터를 사용하면 에이전트가 특정 tool을 반드시 사용하도록(\"<strong>required</strong>\"), 사용하지 않도록(\"<strong>none</strong>\"), 또는 지정된 도구만 사용하도록(\"get_weather\") 강제할 수 있습니다.</li>\n</ul>\n<h5 id=\"context-local-context\" style=\"position:relative;\"><a href=\"#context-local-context\" aria-label=\"context local context permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Context: Local Context</h5>\n<p>Context는 의존성 주입 도구(dependency-injection tool)입니다. 이것은  <code class=\"language-text\">Runner.run()</code>에 전달하는 객체이며, 모든 agent, tool, handoff 등에 전달되고, 에이전트 실행에 필요한 의존성이나 상태 정보들을 보관하는 공간 역할을 합니다. Context로는 아무 Python 객체나 제공할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@dataclass</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">UserContext</span><span class=\"token punctuation\">:</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span>\n    uid<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span>\n    is_pro_user<span class=\"token punctuation\">:</span> <span class=\"token builtin\">bool</span>\n\n    <span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">fetch_purchases</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span>Purchase<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\nagent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">[</span>UserContext<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Local context는 <code class=\"language-text\">RunContextWrapper</code> 클래스와 그 안의 <code class=\"language-text\">context</code> 속성을 통해 나타납니다. 동작 방식은 다음과 같습니다.</p>\n<ol>\n<li>파이썬 객체를 생성합니다. 일반적 패턴은 dataclass나 Pydantic 객체를 사용하는 것입니다.</li>\n<li>그 객체를 다양한 run 메서드(예: <code class=\"language-text\">Runner.run(..., context=whatever)</code>)에 전달합니다.</li>\n<li>모든 tool 호출, 라이프사이클 hook 등에서는 <code class=\"language-text\">RunContextWrapper[T]</code> 타입의 래퍼 객체가 전달되며, 여기서 <code class=\"language-text\">T</code>는 우리가 생성한 컨텍스트 객체 타입을 의미합니다. 실제 객체에는 <code class=\"language-text\">wrapper.context</code>로 접근하면 됩니다.</li>\n</ol>\n<p>주어진 agent 실행에서 모든 agent, tool 함수, 라이프사이클 등은 반드시 같은 종류의 context를 사용해야 합니다. 아래 예시를 통해 이해해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> asyncio\n<span class=\"token keyword\">from</span> dataclasses <span class=\"token keyword\">import</span> dataclass\n\n<span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> Agent<span class=\"token punctuation\">,</span> RunContextWrapper<span class=\"token punctuation\">,</span> Runner<span class=\"token punctuation\">,</span> function_tool\n\n<span class=\"token decorator annotation punctuation\">@dataclass</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">UserInfo</span><span class=\"token punctuation\">:</span>  \n    name<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span>\n    uid<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span>\n\n<span class=\"token decorator annotation punctuation\">@function_tool</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">fetch_user_age</span><span class=\"token punctuation\">(</span>wrapper<span class=\"token punctuation\">:</span> RunContextWrapper<span class=\"token punctuation\">[</span>UserInfo<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">:</span>  \n    <span class=\"token triple-quoted-string string\">\"\"\"Fetch the age of the user. Call this function to get user's age information.\"\"\"</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"The user </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>wrapper<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span></span><span class=\"token string\"> is 47 years old\"</span></span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    user_info <span class=\"token operator\">=</span> UserInfo<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"John\"</span><span class=\"token punctuation\">,</span> uid<span class=\"token operator\">=</span><span class=\"token number\">123</span><span class=\"token punctuation\">)</span>\n\n    agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">[</span>UserInfo<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>  \n        name<span class=\"token operator\">=</span><span class=\"token string\">\"Assistant\"</span><span class=\"token punctuation\">,</span>\n        tools<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>fetch_user_age<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span>\n\n    result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Runner<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>  \n        starting_agent<span class=\"token operator\">=</span>agent<span class=\"token punctuation\">,</span>\n        <span class=\"token builtin\">input</span><span class=\"token operator\">=</span><span class=\"token string\">\"What is the age of the user?\"</span><span class=\"token punctuation\">,</span>\n        context<span class=\"token operator\">=</span>user_info<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>final_output<span class=\"token punctuation\">)</span>  \n    <span class=\"token comment\"># The user John is 47 years old.</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    asyncio<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h5 id=\"context-agentllm-context\" style=\"position:relative;\"><a href=\"#context-agentllm-context\" aria-label=\"context agentllm context permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Context: Agent/LLM context</h5>\n<p>LLM이 호출될 때, 모델이 볼 수 있는 유일한 데이터는 대화(conversation) 이력에서 옵니다. 즉, LLM이 새로운 데이터를 활용하려면 반드시 그 데이터가 대화 이력에 남을 방식으로 제공해야 합니다. 방법은 다음과 같습니다.</p>\n<ol>\n<li>Agent의 <code class=\"language-text\">instructions</code>에 시스템 프롬프트로써 추가. 시스템 프롬프트는 고정 문자열일 수도 있고, context를 받아서 문자열을 반환하는 동적 함수일 수도 있습니다.</li>\n<li><code class=\"language-text\">Runner.run</code>을 호출할 때 <code class=\"language-text\">input</code>(입력 메시지)에 포함시키기.</li>\n<li>여러 tool을 통해 노출하기. LLM이 필요한 시점에 데이터를 요청하도록 할 수 있습니다.</li>\n</ol>\n<h3 id=\"4-advanced-topics\" style=\"position:relative;\"><a href=\"#4-advanced-topics\" aria-label=\"4 advanced topics permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Advanced Topics</h3>\n<p>이 파트에서는 복잡한 멀티 에이전트 시스템을 구축하고, 이들이 안전하고 신뢰성 있게 작동하도록 보장하는 방법을 다룹니다.</p>\n<h5 id=\"session\" style=\"position:relative;\"><a href=\"#session\" aria-label=\"session permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Session</h5>\n<p>LLM은 본질적으로 상태가 없기 때문에(stateless), 대화의 맥락을 유지하기 위해서는 매번 이전 대화 기록을 함께 전달해야 합니다. 물론 <code class=\"language-text\">.to_input_list()</code>를 사용하는 방법도 있지만, session을 사용하는 방법도 있습니다.</p>\n<p>Sessions는 여러 <code class=\"language-text\">Runner.run()</code> 호출에 걸쳐 대화 기록을 자동으로 관리해주는 OpenAI Agent SDK의 내장 솔루션입니다. 이를 통해 개발자는 번거롭고 오류가 발생하기 쉬운 수동 상태 관리 과정에서 벗어날 수 있습니다.</p>\n<p>Runner는 실행 전에 세션에서 이전 기록을 가져오고, 실행 후에는 새로운 상호작용 내용을 다시 세션에 저장합니다. <code class=\"language-text\">SQLiteSession</code>이나 <code class=\"language-text\">SQLAlchemySession</code>과 같은 Session 객체를 생성하여 Runner에 전달하는 방식으로 간단하게 사용할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 세션은 실행 간의 대화 기록을 자동으로 유지하고 가져옵니다.</span>\n<span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> Agent<span class=\"token punctuation\">,</span> Runner<span class=\"token punctuation\">,</span> SQLiteSession\n\nassistant <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"Assistant\"</span><span class=\"token punctuation\">,</span> instructions<span class=\"token operator\">=</span><span class=\"token string\">\"You are a helpful assistant.\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 고유한 대화 ID와 연결된 세션 생성</span>\nsession <span class=\"token operator\">=</span> SQLiteSession<span class=\"token punctuation\">(</span><span class=\"token string\">\"user_conversation_42\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 첫 번째 턴</span>\n<span class=\"token keyword\">await</span> Runner<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>assistant<span class=\"token punctuation\">,</span> <span class=\"token string\">\"My name is Alex.\"</span><span class=\"token punctuation\">,</span> session<span class=\"token operator\">=</span>session<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 두 번째 턴 - 에이전트가 이름을 기억합니다.</span>\nresult <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Runner<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>assistant<span class=\"token punctuation\">,</span> <span class=\"token string\">\"What is my name?\"</span><span class=\"token punctuation\">,</span> session<span class=\"token operator\">=</span>session<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>final_output<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 예상 출력: \"Your name is Alex.\"</span></code></pre></div>\n<h5 id=\"handsoff\" style=\"position:relative;\"><a href=\"#handsoff\" aria-label=\"handsoff permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Handsoff</h5>\n<p>Handsoff는 한 에이전트가 특정 작업을 더 전문화된 다른 에이전트에게 위임(delegate)하는 메커니즘입니다. 이는 모듈화된 멀티 에이전트 시스템을 구축하기 위한 핵심 패턴입니다.</p>\n<p>Handsoff는 부모 에이전트에게 <strong>특별한 종류의 tool</strong>로써 표현됩니다. LLM이 이 tool를 호출하기로 결정하면, SDK는 이를 가로채 대화의 제어권과 기록을 목표 에이전트에게 이전합니다.</p>\n<p>Agent 생성자의 <code class=\"language-text\">handoffs</code> 리스트를 사용하여 에이전트가 수행할 수 있는 잠재적인 handoff를 정의할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># triage_agent는 전문화된 에이전트로의 핸드오프를 구성합니다.</span>\nhistory_tutor_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"History Tutor\"</span><span class=\"token punctuation\">,</span> instructions<span class=\"token operator\">=</span><span class=\"token string\">\"...\"</span><span class=\"token punctuation\">)</span>\nmath_tutor_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"Math Tutor\"</span><span class=\"token punctuation\">,</span> instructions<span class=\"token operator\">=</span><span class=\"token string\">\"...\"</span><span class=\"token punctuation\">)</span>\n\ntriage_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"Triage Agent\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"You determine which agent to use based on the user's homework question.\"</span><span class=\"token punctuation\">,</span>\n    handoffs<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>history_tutor_agent<span class=\"token punctuation\">,</span> math_tutor_agent<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Runner는 LLM의 결정에 따라 핸드오프를 자동으로 처리합니다.</span>\nresult <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Runner<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>triage_agent<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Who was Julius Caesar?\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 결과는 history_tutor_agent로부터 생성됩니다.</span></code></pre></div>\n<p><code class=\"language-text\">handoff()</code> 유틸리티 함수를 사용하면 <code class=\"language-text\">on_handoff</code> 콜백(전달 전 데이터 가져오기)이나 <code class=\"language-text\">input_filter</code>(다음 에이전트로 전달되는 기록 정리)와 같은 고급 사용자 정의가 가능합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> Agent<span class=\"token punctuation\">,</span> handoff<span class=\"token punctuation\">,</span> RunContextWrapper\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">on_handoff</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">:</span> RunContextWrapper<span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Handoff called\"</span><span class=\"token punctuation\">)</span>\n\nagent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"My agent\"</span><span class=\"token punctuation\">)</span>\n\nhandoff_obj <span class=\"token operator\">=</span> handoff<span class=\"token punctuation\">(</span>\n    agent<span class=\"token operator\">=</span>agent<span class=\"token punctuation\">,</span>\n    on_handoff<span class=\"token operator\">=</span>on_handoff<span class=\"token punctuation\">,</span>\n    tool_name_override<span class=\"token operator\">=</span><span class=\"token string\">\"custom_handoff_tool\"</span><span class=\"token punctuation\">,</span>\n    tool_description_override<span class=\"token operator\">=</span><span class=\"token string\">\"Custom description\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Handoff가 발생하면, 마치 새로운 에이전트가 대화를 인계받아 전체 이전 대화 이력을 모두 볼 수 있게 됩니다. 만약 이러한 동작을 변경하고 싶다면, <code class=\"language-text\">input_filter</code>를 설정할 수도 있습니다. input filter는 기존 입력을 <code class=\"language-text\">HandoffInputData</code> 형태로 받아 새로운 <code class=\"language-text\">HandoffInputData</code>를 반환해야 하는 함수입니다. </p>\n<p>일반적으로 자주 쓰이는 패턴(예: 대화 이력에서 모든 tool 호출을 제거하는 것 등)은 <code class=\"language-text\">agents.extensions.handoff_filters</code>에 이미 구현되어 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> Agent<span class=\"token punctuation\">,</span> handoff\n<span class=\"token keyword\">from</span> agents<span class=\"token punctuation\">.</span>extensions <span class=\"token keyword\">import</span> handoff_filters\n\nagent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"FAQ agent\"</span><span class=\"token punctuation\">)</span>\n\nhandoff_obj <span class=\"token operator\">=</span> handoff<span class=\"token punctuation\">(</span>\n    agent<span class=\"token operator\">=</span>agent<span class=\"token punctuation\">,</span>\n    input_filter<span class=\"token operator\">=</span>handoff_filters<span class=\"token punctuation\">.</span>remove_all_tools<span class=\"token punctuation\">,</span> \n<span class=\"token punctuation\">)</span></code></pre></div>\n<h5 id=\"guardrails\" style=\"position:relative;\"><a href=\"#guardrails\" aria-label=\"guardrails permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Guardrails</h5>\n<p>Guardrails은 에이전트의 입력과 출력에 대한 유효성 검사를 수행하는 함수로, 에이전트의 주 로직과 병렬로 실행됩니다.</p>\n<p>\"<strong>Tripwire</strong>\" 메커니즘: guardrails의 조건이 충족되면(예: 유해 콘텐츠 감지), \"Tripwire\"가 작동하여 즉시 예외를 발생시키고 실행을 중단시킵니다.</p>\n<ul>\n<li><code class=\"language-text\">@input_guardrail</code>: 첫 번째 에이전트가 실행되기 전에 실행되어 초기 사용자 입력을 검증합니다.</li>\n<li><code class=\"language-text\">@output_guardrail</code>: 마지막 에이전트가 실행된 후에 실행되어 최종 응답을 사용자에게 보내기 전에 검증합니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 가드레일은 입력과 출력을 검증하는 강력한 방법을 제공합니다.</span>\n<span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> Agent<span class=\"token punctuation\">,</span> input_guardrail<span class=\"token punctuation\">,</span> GuardrailFunctionOutput<span class=\"token punctuation\">,</span> Runner\n<span class=\"token keyword\">from</span> agents<span class=\"token punctuation\">.</span>exceptions <span class=\"token keyword\">import</span> InputGuardrailTripwireTriggered\n\n<span class=\"token decorator annotation punctuation\">@input_guardrail</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">profanity_check_guardrail</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> agent<span class=\"token punctuation\">,</span> input_data<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> GuardrailFunctionOutput<span class=\"token punctuation\">:</span>\n    is_inappropriate <span class=\"token operator\">=</span> <span class=\"token string\">\"badword\"</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>input_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> GuardrailFunctionOutput<span class=\"token punctuation\">(</span>\n        output_info<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"reason\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Profanity detected\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        tripwire_triggered<span class=\"token operator\">=</span>is_inappropriate<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span>\n\nsafe_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"Safe Agent\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"You are a helpful and friendly assistant.\"</span><span class=\"token punctuation\">,</span>\n    input_guardrails<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>profanity_check_guardrail<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">await</span> Runner<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>safe_agent<span class=\"token punctuation\">,</span> <span class=\"token string\">\"This is a badword query.\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">except</span> InputGuardrailTripwireTriggered <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Guardrail tripped! Reason: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>e<span class=\"token punctuation\">.</span>output_info<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"5-utilities\" style=\"position:relative;\"><a href=\"#5-utilities\" aria-label=\"5 utilities permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Utilities</h3>\n<p>이 파트에서는 에이전틱 시스템을 구축하고 유지보수하기 위한 실용적인 도구와 기술을 살펴봅니다.</p>\n<h5 id=\"tracing\" style=\"position:relative;\"><a href=\"#tracing\" aria-label=\"tracing permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tracing</h5>\n<p>복잡한 에이전트 상호작용은 디버깅하기 어려울 수 있습니다. 이런 경우에 tracing을 통해 에이전트 워크플로우를 시각화하할 수 있습니다. Tracing은 기본적으로 활성화되어 있으며, 실행 결과는 OpenAI Traces 대시보드에서 확인할 수 있습니다. </p>\n<p>아래처럼<code class=\"language-text\">trace()</code> 함수를 사용하여 여러 실행을 단일 트레이스로 그룹화하는 고급 기능도 지원합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> Agent<span class=\"token punctuation\">,</span> Runner<span class=\"token punctuation\">,</span> trace\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"Joke generator\"</span><span class=\"token punctuation\">,</span> instructions<span class=\"token operator\">=</span><span class=\"token string\">\"Tell funny jokes.\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">with</span> trace<span class=\"token punctuation\">(</span><span class=\"token string\">\"Joke workflow\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> \n        first_result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Runner<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>agent<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Tell me a joke\"</span><span class=\"token punctuation\">)</span>\n        second_result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Runner<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>agent<span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"Rate this joke: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>first_result<span class=\"token punctuation\">.</span>final_output<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Joke: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>first_result<span class=\"token punctuation\">.</span>final_output<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Rating: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>second_result<span class=\"token punctuation\">.</span>final_output<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></code></pre></div>\n<h5 id=\"repl-utility\" style=\"position:relative;\"><a href=\"#repl-utility\" aria-label=\"repl utility permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>REPL utility</h5>\n<p>UI를 구축하지 않고 에이전트의 대화 능력을 빠르고 상호작용적으로 테스트하고 싶은 경우에는, <code class=\"language-text\">run_demo_loop</code> 유틸리티를 사용해볼 수 있습니다. 아래 코드를 실행시 터미널에서 대화형 채팅 세션을 시작할 수 있으며, 대화 기록을 자동으로 처리하고 에이전트의 출력을 스트리밍합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># REPL 유틸리티는 빠르고 상호작용적인 테스트에 완벽합니다.</span>\n<span class=\"token keyword\">import</span> asyncio\n<span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> Agent<span class=\"token punctuation\">,</span> run_demo_loop\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"Assistant\"</span><span class=\"token punctuation\">,</span> instructions<span class=\"token operator\">=</span><span class=\"token string\">\"You are a helpful assistant.\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">await</span> run_demo_loop<span class=\"token punctuation\">(</span>agent<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    asyncio<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h5 id=\"draw_graph\" style=\"position:relative;\"><a href=\"#draw_graph\" aria-label=\"draw_graph permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>draw_graph</h5>\n<p>멀티 에이전트 시스템이 커질수록 agent, tool, handoff 등의 관계를 파악하기 어려워집니다. <code class=\"language-text\">draw_graph</code> 유틸리티는 Graphviz를 사용하여 에이전트와 그 연결 관계를 시각적인 다이어그램으로 생성해줍니다. <code class=\"language-text\">pip install &quot;openai-agents[viz]&quot;</code>로 필요한 패키지를 설치한 후, 간단한 코드를 통해 그래프를 생성할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> os\n\n<span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> Agent<span class=\"token punctuation\">,</span> function_tool\n<span class=\"token keyword\">from</span> agents<span class=\"token punctuation\">.</span>mcp<span class=\"token punctuation\">.</span>server <span class=\"token keyword\">import</span> MCPServerStdio\n<span class=\"token keyword\">from</span> agents<span class=\"token punctuation\">.</span>extensions<span class=\"token punctuation\">.</span>visualization <span class=\"token keyword\">import</span> draw_graph\n\n<span class=\"token decorator annotation punctuation\">@function_tool</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_weather</span><span class=\"token punctuation\">(</span>city<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"The weather in </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>city<span class=\"token punctuation\">}</span></span><span class=\"token string\"> is sunny.\"</span></span>\n\nspanish_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"Spanish agent\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"You only speak Spanish.\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\n\nenglish_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"English agent\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"You only speak English\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\n\ncurrent_dir <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>dirname<span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>abspath<span class=\"token punctuation\">(</span>__file__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nsamples_dir <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>current_dir<span class=\"token punctuation\">,</span> <span class=\"token string\">\"sample_files\"</span><span class=\"token punctuation\">)</span>\nmcp_server <span class=\"token operator\">=</span> MCPServerStdio<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"Filesystem Server, via npx\"</span><span class=\"token punctuation\">,</span>\n    params<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"command\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"npx\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"args\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"-y\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"@modelcontextprotocol/server-filesystem\"</span><span class=\"token punctuation\">,</span> samples_dir<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\n\ntriage_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"Triage agent\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"Handoff to the appropriate agent based on the language of the request.\"</span><span class=\"token punctuation\">,</span>\n    handoffs<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>spanish_agent<span class=\"token punctuation\">,</span> english_agent<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    tools<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>get_weather<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    mcp_servers<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>mcp_server<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\n\ndraw_graph<span class=\"token punctuation\">(</span>triage_agent<span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 760px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6ac6a055029cc59d0d7c0d8e62e961d0/167b5/25-09-04-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.05263157894737%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABPUlEQVQoz41RyW7CMBDNn/MB+Yqql0q90Aq4NCcECFUtB8QBlUiEJG4T7DrEa5zEdg2oi0oXnqzRaKS3zNizX2CMcfUpQ1fT+eVoNl0DrVv7O7zTkTY2hTh6geov4k/kVhvBs+J1idGS86Rp1D9k4/Jao412fdNoQlZZNgFgAuEjpbu21Wc5u52lrPI85hym6YoxuN3mhJCyLDnnSn1P4TlHUQvMMcJIVYpSKqWCEMUxqKqaMQYAwBg7PkJos9m4XkrptIQQXvAc+HO/M+r4Mz8sw/Fw3L3pDgaDXu82CO76/X7ukjglAJIkwbiAEEZRlKapm3u85pnM8jrHDVaNYpQ5E/IO1x99XC13u1pVglFKiDgMPXsGjv+f42IerhfhulL158HcnbXdv/3ZT/AhMYuzi+HD9f0CFOSgaN8A/VE5BnlO4qAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6ac6a055029cc59d0d7c0d8e62e961d0/15813/25-09-04-1.webp 190w,\n/static/6ac6a055029cc59d0d7c0d8e62e961d0/1cdb2/25-09-04-1.webp 380w,\n/static/6ac6a055029cc59d0d7c0d8e62e961d0/9046c/25-09-04-1.webp 760w,\n/static/6ac6a055029cc59d0d7c0d8e62e961d0/bac22/25-09-04-1.webp 776w\"\n              sizes=\"(max-width: 760px) 100vw, 760px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6ac6a055029cc59d0d7c0d8e62e961d0/a2d4f/25-09-04-1.png 190w,\n/static/6ac6a055029cc59d0d7c0d8e62e961d0/3f520/25-09-04-1.png 380w,\n/static/6ac6a055029cc59d0d7c0d8e62e961d0/3c051/25-09-04-1.png 760w,\n/static/6ac6a055029cc59d0d7c0d8e62e961d0/167b5/25-09-04-1.png 776w\"\n            sizes=\"(max-width: 760px) 100vw, 760px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6ac6a055029cc59d0d7c0d8e62e961d0/3c051/25-09-04-1.png\"\n            alt=\"img\"\n            title=\"img\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<center><p><i>https://openai.github.io/openai-agents-python/visualization/</i></p></center>\n<h5 id=\"litellm-integration\" style=\"position:relative;\"><a href=\"#litellm-integration\" aria-label=\"litellm integration permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>LiteLLM Integration</h5>\n<p> <code class=\"language-text\">LitellmModel</code> 클래스를 사용하여 SDK를 Anthropic, Google을 포함한 100개 이상의 다른 LLM에 연결할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># SDK는 LiteLLM을 통해 모델에 구애받지 않습니다.</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">from</span> agents <span class=\"token keyword\">import</span> Agent\n<span class=\"token keyword\">from</span> agents<span class=\"token punctuation\">.</span>extensions<span class=\"token punctuation\">.</span>models<span class=\"token punctuation\">.</span>litellm_model <span class=\"token keyword\">import</span> LitellmModel\n\n<span class=\"token comment\"># LiteLLM 모델 래퍼 구성</span>\nclaude_model <span class=\"token operator\">=</span> LitellmModel<span class=\"token punctuation\">(</span>\n    model<span class=\"token operator\">=</span><span class=\"token string\">\"claude-3-opus-20240229\"</span><span class=\"token punctuation\">,</span>\n    api_key<span class=\"token operator\">=</span>os<span class=\"token punctuation\">.</span>environ<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"ANTHROPIC_API_KEY\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 환경 변수에서 키 가져오기</span>\n<span class=\"token punctuation\">)</span>\n\nclaude_agent <span class=\"token operator\">=</span> Agent<span class=\"token punctuation\">(</span>\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"Claude Assistant\"</span><span class=\"token punctuation\">,</span>\n    instructions<span class=\"token operator\">=</span><span class=\"token string\">\"You are a helpful assistant powered by Claude.\"</span><span class=\"token punctuation\">,</span>\n    model<span class=\"token operator\">=</span>claude_model\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"6-conclusion\" style=\"position:relative;\"><a href=\"#6-conclusion\" aria-label=\"6 conclusion permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Conclusion</h3>\n<p>지금까지 OpenAI Agent SDK의 핵심적인 기능들을 살펴보았습니다. 가장 기본적인 <code class=\"language-text\">Agent</code>와 <code class=\"language-text\">Runner</code>의 개념부터, 에이전트의 능력을 확장하는 <code class=\"language-text\">Tools</code>와 <code class=\"language-text\">Context</code>, 그리고 여러 에이전트가 협력하는 복잡한 시스템을 구축하기 위한 <code class=\"language-text\">Handoffs</code>와 <code class=\"language-text\">Guardrails</code>와 같은 고급 기능까지 다루었습니다.</p>\n<p>직접 사용해보면서 느끼는 OpenAI Agent SDK의 가장 큰 매력은 복잡한 추상화 대신 친숙한 파이썬 문법과 데코레이터를 기반으로 설계되었다는 점과 개발자들이 최소한의 학습 곡선으로 빠르게 아이디어를 프로토타이핑하고 실제 애플리케이션으로 발전시킬 수 있다는 점인 것 같습니다. 또한 기본 기능들 뿐만 아니라, 개발 과정에서 꼭 필요한 <code class=\"language-text\">Tracing</code>, <code class=\"language-text\">REPL</code>, <code class=\"language-text\">draw_graph</code>와 같은 실용적인 유틸리티 함수들도 모두 존재한다는 점도 큰 장점인 것 같습니다.</p>\n<p>혹시 앞으로 에이전틱 워크플로우를 만들 계획이 있으신 분이라면, 위 정리 글을 참고하시면서 OpenAI Agent SDK를 활용하여 에이전트를 구축해보시는 것을 추천드립니다.</p>","tableOfContents":"<ul>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#1-quick-start\">1. Quick Start</a></li>\n<li>\n<p><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#2-basic-concepts\">2. Basic Concepts</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#agents\">Agents</a></li>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#runner\">Runner</a></li>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#runresult\">RunResult</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#3-tools--context\">3. Tools &#x26; Context</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#tools\">Tools</a></li>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#context-local-context\">Context: Local Context</a></li>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#context-agentllm-context\">Context: Agent/LLM context</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#4-advanced-topics\">4. Advanced Topics</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#session\">Session</a></li>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#handsoff\">Handsoff</a></li>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#guardrails\">Guardrails</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#5-utilities\">5. Utilities</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#tracing\">Tracing</a></li>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#repl-utility\">REPL utility</a></li>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#draw_graph\">draw_graph</a></li>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#litellm-integration\">LiteLLM Integration</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"/Archive/25-09-04%20OpenAI%20Agent%20SDK/#6-conclusion\">6. Conclusion</a></li>\n</ul>","frontmatter":{"path":"/cheatsheet/25-09-04/","title":"OpenAI Agent SDK 기초 가이드","category":"Cheat Sheet","date":"2025-09-04"}}},"pageContext":{}},"staticQueryHashes":["2390655019","256249292","63159454"]}